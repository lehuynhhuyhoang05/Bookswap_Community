-- =============================================
-- Bookswap Seed Data (Schema-Aligned)
-- Fixed to match actual entities (no display_name, owner_id etc.)
-- =============================================
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- Truncate existing data (LOCAL DEV ONLY!)
TRUNCATE TABLE user_activity_logs;
TRUNCATE TABLE messages;
TRUNCATE TABLE conversations;
TRUNCATE TABLE reviews;
TRUNCATE TABLE exchange_books;
TRUNCATE TABLE exchanges;
TRUNCATE TABLE exchange_request_books;
TRUNCATE TABLE exchange_requests;
TRUNCATE TABLE books;
TRUNCATE TABLE members;
TRUNCATE TABLE users;
SET FOREIGN_KEY_CHECKS = 1;

-- Users
INSERT INTO users (user_id, email, password_hash, role, is_email_verified, created_at) VALUES
 ('00000000-0000-0000-0000-000000000001','banned@test.com','$2a$10$hash111111111111111111111111111111111111111111','MEMBER',0,NOW()),
 ('00000000-0000-0000-0000-000000000002','limited@test.com','$2a$10$hash222222222222222222222222222222222222222222','MEMBER',1,NOW()),
 ('00000000-0000-0000-0000-000000000003','medium@test.com','$2a$10$hash333333333333333333333333333333333333333333','MEMBER',1,NOW()),
 ('00000000-0000-0000-0000-000000000004','vip@test.com','$2a$10$hash444444444444444444444444444444444444444444','MEMBER',1,NOW()),
 ('00000000-0000-0000-0000-000000000005','disputer@test.com','$2a$10$hash555555555555555555555555555555555555555555','MEMBER',1,NOW()),
 ('00000000-0000-0000-0000-000000000006','noshow@test.com','$2a$10$hash666666666666666666666666666666666666666666','MEMBER',1,NOW()),
 ('00000000-0000-0000-0000-000000000007','admin@test.com','$2a$10$hash777777777777777777777777777777777777777777','ADMIN',1,NOW());

-- Members (minimal columns + trust tiers)
INSERT INTO members (member_id, user_id, trust_score, total_exchanges, completed_exchanges, cancelled_exchanges, created_at, updated_at) VALUES
 ('11111111-1111-1111-1111-111111111111','00000000-0000-0000-0000-000000000001',5.00,0,0,0,NOW(),NOW()),
 ('22222222-2222-2222-2222-222222222222','00000000-0000-0000-0000-000000000002',15.00,2,0,1,NOW(),NOW()),
 ('33333333-3333-3333-3333-333333333333','00000000-0000-0000-0000-000000000003',30.00,3,1,1,NOW(),NOW()),
 ('44444444-4444-4444-4444-444444444444','00000000-0000-0000-0000-000000000004',65.00,5,2,1,NOW(),NOW()),
 ('55555555-5555-5555-5555-555555555555','00000000-0000-0000-0000-000000000005',45.00,4,1,2,NOW(),NOW()),
 ('66666666-6666-6666-6666-666666666666','00000000-0000-0000-0000-000000000006',40.00,3,0,2,NOW(),NOW());

-- Books (using owner_id)
INSERT INTO books (book_id, owner_id, title, author, isbn, book_condition, description, status, created_at, updated_at) VALUES
 ('aaaaaaa1-aaaa-aaaa-aaaa-aaaaaaaaaaa1','22222222-2222-2222-2222-222222222222','Clean Code','Robert C. Martin','9780132350884','GOOD','Classic craftsmanship book','AVAILABLE',NOW(),NOW()),
 ('aaaaaaa2-aaaa-aaaa-aaaa-aaaaaaaaaaa2','33333333-3333-3333-3333-333333333333','Refactoring','Martin Fowler','9780201485677','GOOD','Improving existing code','AVAILABLE',NOW(),NOW()),
 ('aaaaaaa3-aaaa-aaaa-aaaa-aaaaaaaaaaa3','44444444-4444-4444-4444-444444444444','Design Patterns','GoF','9780201633610','FAIR','Reusable OO patterns','AVAILABLE',NOW(),NOW()),
 ('aaaaaaa4-aaaa-aaaa-aaaa-aaaaaaaaaaa4','55555555-5555-5555-5555-555555555555','Domain-Driven Design','Eric Evans','9780321125217','GOOD','Strategic design','AVAILABLE',NOW(),NOW()),
 ('aaaaaaa5-aaaa-aaaa-aaaa-aaaaaaaaaaa5','66666666-6666-6666-6666-666666666666','The Pragmatic Programmer','Andrew Hunt','9780201616224','GOOD','Journey to mastery','AVAILABLE',NOW(),NOW()),
 ('aaaaaaa6-aaaa-aaaa-aaaa-aaaaaaaaaaa6','44444444-4444-4444-4444-444444444444','Clean Architecture','Robert C. Martin','9780134494166','GOOD','Architectural guidance','EXCHANGING',NOW(),NOW()),
 ('aaaaaaa7-aaaa-aaaa-aaaa-aaaaaaaaaaa7','22222222-2222-2222-2222-222222222222','Distributed Systems','Tanenbaum','9780132143011','FAIR','Concepts & design','AVAILABLE',NOW(),NOW());

-- Exchange Requests (each leads to an Exchange)
INSERT INTO exchange_requests (request_id, requester_id, receiver_id, status, message, created_at, updated_at) VALUES
 ('req00001-0000-0000-0000-000000000001','44444444-4444-4444-4444-444444444444','33333333-3333-3333-3333-333333333333','ACCEPTED','Swap Design Patterns for Refactoring',NOW()-INTERVAL 11 DAY,NOW()-INTERVAL 10 DAY),
 ('req00002-0000-0000-0000-000000000002','22222222-2222-2222-2222-222222222222','33333333-3333-3333-3333-333333333333','ACCEPTED','Request Clean Code vs Refactoring',NOW()-INTERVAL 9 DAY,NOW()-INTERVAL 8 DAY),
 ('req00003-0000-0000-0000-000000000003','44444444-4444-4444-4444-444444444444','66666666-6666-6666-6666-666666666666','ACCEPTED','Swap Design Patterns vs Pragmatic',NOW()-INTERVAL 8 DAY,NOW()-INTERVAL 7 DAY),
 ('req00004-0000-0000-0000-000000000004','55555555-5555-5555-5555-555555555555','66666666-6666-6666-6666-666666666666','ACCEPTED','Try DDD for Pragmatic',NOW()-INTERVAL 7 DAY,NOW()-INTERVAL 6 DAY),
 ('req00005-0000-0000-0000-000000000005','44444444-4444-4444-4444-444444444444','55555555-5555-5555-5555-555555555555','ACCEPTED','Clean Architecture vs DDD',NOW()-INTERVAL 5 DAY,NOW()-INTERVAL 4 DAY),
 ('req00006-0000-0000-0000-000000000006','33333333-3333-3333-3333-333333333333','22222222-2222-2222-2222-222222222222','ACCEPTED','Refactoring for Distributed Systems',NOW()-INTERVAL 4 DAY,NOW()-INTERVAL 3 DAY),
 ('req00007-0000-0000-0000-000000000007','44444444-4444-4444-4444-444444444444','22222222-2222-2222-2222-222222222222','PENDING','Offer Clean Architecture vs Clean Code',NOW()-INTERVAL 2 DAY,NOW()-INTERVAL 1 DAY);

-- Exchange Request Books (link offered/requested)
INSERT INTO exchange_request_books (exchange_request_book_id, request_id, book_id, offered_by_requester, book_type, created_at) VALUES
 ('erb00001-0000-0000-0000-000000000001','req00001-0000-0000-0000-000000000001','aaaaaaa3-aaaa-aaaa-aaaa-aaaaaaaaaaa3',1,'OFFERED',NOW()-INTERVAL 11 DAY),
 ('erb00002-0000-0000-0000-000000000002','req00001-0000-0000-0000-000000000001','aaaaaaa2-aaaa-aaaa-aaaa-aaaaaaaaaaa2',0,'REQUESTED',NOW()-INTERVAL 11 DAY),
 ('erb00003-0000-0000-0000-000000000003','req00002-0000-0000-0000-000000000002','aaaaaaa1-aaaa-aaaa-aaaa-aaaaaaaaaaa1',1,'OFFERED',NOW()-INTERVAL 9 DAY),
 ('erb00004-0000-0000-0000-000000000004','req00002-0000-0000-0000-000000000002','aaaaaaa2-aaaa-aaaa-aaaa-aaaaaaaaaaa2',0,'REQUESTED',NOW()-INTERVAL 9 DAY),
 ('erb00005-0000-0000-0000-000000000005','req00003-0000-0000-0000-000000000003','aaaaaaa3-aaaa-aaaa-aaaa-aaaaaaaaaaa3',1,'OFFERED',NOW()-INTERVAL 8 DAY),
 ('erb00006-0000-0000-0000-000000000006','req00003-0000-0000-0000-000000000003','aaaaaaa5-aaaa-aaaa-aaaa-aaaaaaaaaaa5',0,'REQUESTED',NOW()-INTERVAL 8 DAY),
 ('erb00007-0000-0000-0000-000000000007','req00004-0000-0000-0000-000000000004','aaaaaaa4-aaaa-aaaa-aaaa-aaaaaaaaaaa4',1,'OFFERED',NOW()-INTERVAL 7 DAY),
 ('erb00008-0000-0000-0000-000000000008','req00004-0000-0000-0000-000000000004','aaaaaaa5-aaaa-aaaa-aaaa-aaaaaaaaaaa5',0,'REQUESTED',NOW()-INTERVAL 7 DAY),
 ('erb00009-0000-0000-0000-000000000009','req00005-0000-0000-0000-000000000005','aaaaaaa6-aaaa-aaaa-aaaa-aaaaaaaaaaa6',1,'OFFERED',NOW()-INTERVAL 5 DAY),
 ('erb00010-0000-0000-0000-000000000010','req00005-0000-0000-0000-000000000005','aaaaaaa4-aaaa-aaaa-aaaa-aaaaaaaaaaa4',0,'REQUESTED',NOW()-INTERVAL 5 DAY),
 ('erb00011-0000-0000-0000-000000000011','req00006-0000-0000-0000-000000000006','aaaaaaa2-aaaa-aaaa-aaaa-aaaaaaaaaaa2',1,'OFFERED',NOW()-INTERVAL 4 DAY),
 ('erb00012-0000-0000-0000-000000000012','req00006-0000-0000-0000-000000000006','aaaaaaa7-aaaa-aaaa-aaaa-aaaaaaaaaaa7',0,'REQUESTED',NOW()-INTERVAL 4 DAY),
 ('erb00013-0000-0000-0000-000000000013','req00007-0000-0000-0000-000000000007','aaaaaaa6-aaaa-aaaa-aaaa-aaaaaaaaaaa6',1,'OFFERED',NOW()-INTERVAL 2 DAY),
 ('erb00014-0000-0000-0000-000000000014','req00007-0000-0000-0000-000000000007','aaaaaaa1-aaaa-aaaa-aaaa-aaaaaaaaaaa1',0,'REQUESTED',NOW()-INTERVAL 2 DAY);

-- Exchanges (now referencing request_id)
INSERT INTO exchanges (exchange_id, request_id, member_a_id, member_b_id, status, cancellation_reason, member_a_confirmed, member_b_confirmed, meeting_location, meeting_time, meeting_notes, created_at, updated_at) VALUES
 ('exch00001-0000-0000-0000-000000000001','req00001-0000-0000-0000-000000000001','44444444-4444-4444-4444-444444444444','33333333-3333-3333-3333-333333333333','COMPLETED',NULL,1,1,'Central Library',NOW()+INTERVAL 1 DAY,'Bring both books',NOW()-INTERVAL 10 DAY,NOW()-INTERVAL 9 DAY),
 ('exch00002-0000-0000-0000-000000000002','req00002-0000-0000-0000-000000000002','22222222-2222-2222-2222-222222222222','33333333-3333-3333-3333-333333333333','CANCELLED','USER_CANCELLED',0,0,'Cafe District 1',NOW()+INTERVAL 2 DAY,'Too busy to meet',NOW()-INTERVAL 8 DAY,NOW()-INTERVAL 8 DAY),
 ('exch00003-0000-0000-0000-000000000003','req00003-0000-0000-0000-000000000003','44444444-4444-4444-4444-444444444444','66666666-6666-6666-6666-666666666666','CANCELLED','NO_SHOW',1,0,'Co-working Space',NOW()-INTERVAL 6 DAY,'Did not appear',NOW()-INTERVAL 7 DAY,NOW()-INTERVAL 7 DAY),
 ('exch00004-0000-0000-0000-000000000004','req00004-0000-0000-0000-000000000004','55555555-5555-5555-5555-555555555555','66666666-6666-6666-6666-666666666666','CANCELLED','BOTH_NO_SHOW',0,0,'Metro Station',NOW()-INTERVAL 5 DAY,'None came',NOW()-INTERVAL 6 DAY,NOW()-INTERVAL 5 DAY),
 ('exch00005-0000-0000-0000-000000000005','req00005-0000-0000-0000-000000000005','44444444-4444-4444-4444-444444444444','55555555-5555-5555-5555-555555555555','CANCELLED','DISPUTE',1,1,'Bookstore District 3',NOW()-INTERVAL 3 DAY,'Disagreement about book condition',NOW()-INTERVAL 4 DAY,NOW()-INTERVAL 3 DAY),
 ('exch00006-0000-0000-0000-000000000006','req00006-0000-0000-0000-000000000006','33333333-3333-3333-3333-333333333333','22222222-2222-2222-2222-222222222222','EXPIRED',NULL,0,1,'Online meet',NOW()-INTERVAL 1 DAY,'MediumUser never confirmed',NOW()-INTERVAL 3 DAY,NOW()-INTERVAL 2 DAY),
 ('exch00007-0000-0000-0000-000000000007','req00007-0000-0000-0000-000000000007','44444444-4444-4444-4444-444444444444','22222222-2222-2222-2222-222222222222','PENDING',NULL,0,0,'City Park',NOW()+INTERVAL 2 DAY,'Awaiting acceptance',NOW()-INTERVAL 1 DAY,NOW()-INTERVAL 1 DAY);

-- Exchange Books (directional mapping)
INSERT INTO exchange_books (exchange_book_id, exchange_id, book_id, from_member_id, to_member_id, exchange_order, created_at) VALUES
 ('exbk00001-0000-0000-0000-000000000001','exch00001-0000-0000-0000-000000000001','aaaaaaa3-aaaa-aaaa-aaaa-aaaaaaaaaaa3','44444444-4444-4444-4444-444444444444','33333333-3333-3333-3333-333333333333',1,NOW()-INTERVAL 10 DAY),
 ('exbk00002-0000-0000-0000-000000000002','exch00001-0000-0000-0000-000000000001','aaaaaaa2-aaaa-aaaa-aaaa-aaaaaaaaaaa2','33333333-3333-3333-3333-333333333333','44444444-4444-4444-4444-444444444444',2,NOW()-INTERVAL 10 DAY),
 ('exbk00003-0000-0000-0000-000000000003','exch00002-0000-0000-0000-000000000002','aaaaaaa1-aaaa-aaaa-aaaa-aaaaaaaaaaa1','22222222-2222-2222-2222-222222222222','33333333-3333-3333-3333-333333333333',1,NOW()-INTERVAL 8 DAY),
 ('exbk00004-0000-0000-0000-000000000004','exch00002-0000-0000-0000-000000000002','aaaaaaa2-aaaa-aaaa-aaaa-aaaaaaaaaaa2','33333333-3333-3333-3333-333333333333','22222222-2222-2222-2222-222222222222',2,NOW()-INTERVAL 8 DAY),
 ('exbk00005-0000-0000-0000-000000000005','exch00003-0000-0000-0000-000000000003','aaaaaaa3-aaaa-aaaa-aaaa-aaaaaaaaaaa3','44444444-4444-4444-4444-444444444444','66666666-6666-6666-6666-666666666666',1,NOW()-INTERVAL 7 DAY),
 ('exbk00006-0000-0000-0000-000000000006','exch00003-0000-0000-0000-000000000003','aaaaaaa5-aaaa-aaaa-aaaa-aaaaaaaaaaa5','66666666-6666-6666-6666-666666666666','44444444-4444-4444-4444-444444444444',2,NOW()-INTERVAL 7 DAY),
 ('exbk00007-0000-0000-0000-000000000007','exch00004-0000-0000-0000-000000000004','aaaaaaa4-aaaa-aaaa-aaaa-aaaaaaaaaaa4','55555555-5555-5555-5555-555555555555','66666666-6666-6666-6666-666666666666',1,NOW()-INTERVAL 6 DAY),
 ('exbk00008-0000-0000-0000-000000000008','exch00004-0000-0000-0000-000000000004','aaaaaaa5-aaaa-aaaa-aaaa-aaaaaaaaaaa5','66666666-6666-6666-6666-666666666666','55555555-5555-5555-5555-555555555555',2,NOW()-INTERVAL 6 DAY),
 ('exbk00009-0000-0000-0000-000000000009','exch00005-0000-0000-0000-000000000005','aaaaaaa6-aaaa-aaaa-aaaa-aaaaaaaaaaa6','44444444-4444-4444-4444-444444444444','55555555-5555-5555-5555-555555555555',1,NOW()-INTERVAL 4 DAY),
 ('exbk00010-0000-0000-0000-000000000010','exch00005-0000-0000-0000-000000000005','aaaaaaa4-aaaa-aaaa-aaaa-aaaaaaaaaaa4','55555555-5555-5555-5555-555555555555','44444444-4444-4444-4444-444444444444',2,NOW()-INTERVAL 4 DAY),
 ('exbk00011-0000-0000-0000-000000000011','exch00006-0000-0000-0000-000000000006','aaaaaaa2-aaaa-aaaa-aaaa-aaaaaaaaaaa2','33333333-3333-3333-3333-333333333333','22222222-2222-2222-2222-222222222222',1,NOW()-INTERVAL 3 DAY),
 ('exbk00012-0000-0000-0000-000000000012','exch00006-0000-0000-0000-000000000006','aaaaaaa7-aaaa-aaaa-aaaa-aaaaaaaaaaa7','22222222-2222-2222-2222-222222222222','33333333-3333-3333-3333-333333333333',2,NOW()-INTERVAL 3 DAY),
 ('exbk00013-0000-0000-0000-000000000013','exch00007-0000-0000-0000-000000000007','aaaaaaa6-aaaa-aaaa-aaaa-aaaaaaaaaaa6','44444444-4444-4444-4444-444444444444','22222222-2222-2222-2222-222222222222',1,NOW()-INTERVAL 1 DAY),
 ('exbk00014-0000-0000-0000-000000000014','exch00007-0000-0000-0000-000000000007','aaaaaaa1-aaaa-aaaa-aaaa-aaaaaaaaaaa1','22222222-2222-2222-2222-222222222222','44444444-4444-4444-4444-444444444444',2,NOW()-INTERVAL 1 DAY);

-- Reviews (schema-aligned: reviewer_id, reviewee_id)
INSERT INTO reviews (review_id, exchange_id, reviewer_id, reviewee_id, rating, comment, created_at, updated_at) VALUES
 ('rev00001-0000-0000-0000-000000000001','exch00001-0000-0000-0000-000000000001','44444444-4444-4444-4444-444444444444','33333333-3333-3333-3333-333333333333',5,'Great exchange, smooth process!',NOW()-INTERVAL 9 DAY,NOW()-INTERVAL 9 DAY),
 ('rev00002-0000-0000-0000-000000000002','exch00001-0000-0000-0000-000000000001','33333333-3333-3333-3333-333333333333','44444444-4444-4444-4444-444444444444',4,'Book as described.',NOW()-INTERVAL 9 DAY,NOW()-INTERVAL 9 DAY),
 ('rev00003-0000-0000-0000-000000000003','exch00005-0000-0000-0000-000000000005','55555555-5555-5555-5555-555555555555','44444444-4444-4444-4444-444444444444',2,'Dispute about quality.',NOW()-INTERVAL 3 DAY,NOW()-INTERVAL 3 DAY),
 ('rev00004-0000-0000-0000-000000000004','exch00005-0000-0000-0000-000000000005','44444444-4444-4444-4444-444444444444','55555555-5555-5555-5555-555555555555',1,'Condition not as stated.',NOW()-INTERVAL 3 DAY,NOW()-INTERVAL 3 DAY);

-- Conversations (no updated_at column, has last_message_at & total_messages)
INSERT INTO conversations (conversation_id, exchange_request_id, member_a_id, member_b_id, total_messages, last_message_at, created_at) VALUES
 ('conv00001-0000-0000-0000-000000000001','req00007-0000-0000-0000-000000000007','44444444-4444-4444-4444-444444444444','22222222-2222-2222-2222-222222222222',2,NOW()-INTERVAL 1 DAY,NOW()-INTERVAL 1 DAY),
 ('conv00002-0000-0000-0000-000000000002',NULL,'44444444-4444-4444-4444-444444444444','66666666-6666-6666-6666-666666666666',2,NOW()-INTERVAL 7 DAY,NOW()-INTERVAL 7 DAY);

-- Messages (sender_id / receiver_id)
INSERT INTO messages (message_id, conversation_id, sender_id, receiver_id, content, is_read, sent_at, created_at) VALUES
 ('msg00001-0000-0000-0000-000000000001','conv00001-0000-0000-0000-000000000001','44444444-4444-4444-4444-444444444444','22222222-2222-2222-2222-222222222222','Hi, interested in your Clean Code book!',0,NOW()-INTERVAL 1 DAY,NOW()-INTERVAL 1 DAY),
 ('msg00002-0000-0000-0000-000000000002','conv00001-0000-0000-0000-000000000001','22222222-2222-2222-2222-222222222222','44444444-4444-4444-4444-444444444444','Sure, would you trade Design Patterns?',0,NOW()-INTERVAL 1 DAY,NOW()-INTERVAL 1 DAY),
 ('msg00003-0000-0000-0000-000000000003','conv00002-0000-0000-0000-000000000002','44444444-4444-4444-4444-444444444444','66666666-6666-6666-6666-666666666666','You missed the meeting yesterday.',0,NOW()-INTERVAL 7 DAY,NOW()-INTERVAL 7 DAY),
 ('msg00004-0000-0000-0000-000000000004','conv00002-0000-0000-0000-000000000002','66666666-6666-6666-6666-666666666666','44444444-4444-4444-4444-444444444444','Sorry, something came up.',0,NOW()-INTERVAL 7 DAY,NOW()-INTERVAL 7 DAY);

-- User Activity Logs (sample actions)
INSERT INTO user_activity_logs (log_id, user_id, action, entity_type, entity_id, metadata, ip_address, user_agent, created_at) VALUES
 ('ual00001-0000-0000-0000-000000000001','00000000-0000-0000-0000-000000000004','CREATE_EXCHANGE_REQUEST','EXCHANGE_REQUEST','req00007-0000-0000-0000-000000000007',JSON_OBJECT('info','Created request'),NULL,NULL,NOW()-INTERVAL 2 DAY),
 ('ual00002-0000-0000-0000-000000000002','00000000-0000-0000-0000-000000000002','ACCEPT_EXCHANGE_REQUEST','EXCHANGE_REQUEST','req00002-0000-0000-0000-000000000002',JSON_OBJECT('info','Accepted request'),NULL,NULL,NOW()-INTERVAL 8 DAY),
 ('ual00003-0000-0000-0000-000000000003','00000000-0000-0000-0000-000000000006','SEND_MESSAGE','MESSAGE','msg00003-0000-0000-0000-000000000003',JSON_OBJECT('content','You missed the meeting'),NULL,NULL,NOW()-INTERVAL 7 DAY),
 ('ual00004-0000-0000-0000-000000000004','00000000-0000-0000-0000-000000000004','CREATE_REVIEW','REVIEW','rev00001-0000-0000-0000-000000000001',JSON_OBJECT('rating',5),NULL,NULL,NOW()-INTERVAL 9 DAY);

-- =============================================
-- Done (Schema aligned)
-- =============================================
