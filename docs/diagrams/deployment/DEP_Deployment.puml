@startuml DEP_Deployment_v2
' ============================================================
' DEPLOYMENT DIAGRAM - BOOKSWAP SYSTEM
' Version 2.0 - Clean & Professional Design
' ============================================================

skinparam backgroundColor #FFFFFF
skinparam shadowing false
skinparam defaultFontName "Segoe UI"
skinparam defaultFontSize 11

skinparam node {
    BackgroundColor #FAFAFA
    BorderColor #424242
}

skinparam rectangle {
    BackgroundColor<<docker>> #E3F2FD
    BorderColor<<docker>> #1976D2
    BackgroundColor<<network>> #F3E5F5
    BorderColor<<network>> #7B1FA2
}

skinparam database {
    BackgroundColor #E8F5E9
    BorderColor #388E3C
}

skinparam cloud {
    BackgroundColor #FFF8E1
    BorderColor #FFA000
}

skinparam artifact {
    BackgroundColor #FFFFFF
    BorderColor #757575
}

title <size:18>**BookSwap - Deployment Architecture**</size>\n<size:12>Docker Containerized Environment</size>

' ============================================================
' CLIENT TIER
' ============================================================
node "ğŸ‘¤ **User Devices**" as UserDevices {
    artifact "ğŸŒ Web Browser\n(Chrome, Firefox, Edge)" as Browser
    artifact "ğŸ“± Mobile Browser\n(Safari, Chrome Mobile)" as Mobile
}

' ============================================================
' DOCKER HOST
' ============================================================
node "ğŸ–¥ï¸ **Docker Host**\n(Development / Production Server)" as DockerHost {
    
    rectangle "**docker-compose.yml**" <<docker>> as DockerCompose {
        
        ' Frontend Container
        node "ğŸ“¦ **frontend**\nContainer" as FrontendContainer {
            artifact "React Application" as ReactApp {
                file "Vite Dev Server"
                file "Static Assets"
            }
            component "Port: **5173**" as FEPort
        }
        
        ' Backend Container
        node "ğŸ“¦ **backend**\nContainer" as BackendContainer {
            artifact "NestJS Application" as NestApp {
                file "REST API"
                file "WebSocket Server"
                file "Scheduler Jobs"
            }
            component "Port: **3000**" as BEPort
        }
        
        ' MySQL Container
        node "ğŸ“¦ **mysql**\nContainer" as MySQLContainer {
            database "MySQL 8.0" as MySQL {
                file "bookswap_db"
            }
            component "Port: **3306**" as DBPort
        }
        
        ' Volumes
        rectangle "**Volumes**" as Volumes {
            storage "mysql_data\n(Persistent)" as MySQLVolume
            storage "uploads/\n(User Files)" as UploadsVolume
        }
        
        ' Network
        rectangle "**bookswap_network**\n(Bridge Network)" <<network>> as Network {
        }
    }
}

' ============================================================
' EXTERNAL SERVICES
' ============================================================
cloud "â˜ï¸ **External Services**" as External {
    node "Google Books API" as GoogleBooks {
        artifact "REST API" as GoogleAPI
    }
    
    node "SMTP Server" as SMTP {
        artifact "Email Service\n(Gmail/SendGrid)" as EmailAPI
    }
}

' ============================================================
' CONNECTIONS
' ============================================================

' User to Frontend
Browser --> FrontendContainer : "HTTP :5173"
Mobile --> FrontendContainer : "HTTP :5173"

' Frontend to Backend
FrontendContainer --> BackendContainer : "HTTP :3000\nWebSocket"

' Backend to Database
BackendContainer --> MySQLContainer : "TCP :3306"

' Backend to External
BackendContainer --> GoogleBooks : "HTTPS"
BackendContainer --> SMTP : "SMTP/TLS"

' Volumes
MySQLContainer --> MySQLVolume : mount
BackendContainer --> UploadsVolume : mount

' Network connections (all containers in same network)
FrontendContainer -[hidden]- Network
BackendContainer -[hidden]- Network
MySQLContainer -[hidden]- Network

' ============================================================
' CONFIGURATION DETAILS
' ============================================================
note right of DockerCompose
    **Environment Variables:**
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    DB_HOST=mysql
    DB_PORT=3306
    DB_DATABASE=bookswap_db
    JWT_SECRET=***
    
    **Port Mapping:**
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    Frontend: 5173:5173
    Backend:  3000:3000
    MySQL:    3306:3306
end note

note bottom of Volumes
    **Persistent Data:**
    â€¢ Database files
    â€¢ Uploaded images
    â€¢ User attachments
end note

' ============================================================
' LEGEND
' ============================================================
legend right
    |= Icon |= Component |
    | ğŸ“¦ | Docker Container |
    | ğŸŒ | Web Application |
    | ğŸ“± | Mobile Client |
    | â˜ï¸ | Cloud Service |
    | ğŸ’¾ | Persistent Volume |
endlegend

@enduml
